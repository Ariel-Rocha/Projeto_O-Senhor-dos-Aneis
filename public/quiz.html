<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz - O Senhor dos Anéis</title>
    <style>
        /* Mesmo estilo anterior */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }

        .logonavbar {
            display: flex;
            align-items: center;
            background-color: #333;
            color: #fff;
            padding: 10px 20px;
        }

        .logonavbar img {
            height: 40px;
            margin-right: 10px;
        }

        .itens {
            display: flex;
            justify-content: center;
            padding: 10px;
            background-color: #444;
        }

        .itens a {
            margin: 0 10px;
            color: white;
            text-decoration: none;
        }

        .itens a:hover {
            text-decoration: underline;
        }

        .calculadorafixa {
            margin: 30px auto;
            padding: 20px;
            max-width: 800px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.2);
        }

        h1 {
            text-align: center;
            color: #333;
        }

        .inputsimc {
            margin-top: 20px;
        }

        .inputsimc span {
            display: block;
            margin: 15px 0 5px;
            font-weight: bold;
        }

        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .botaocadastro {
            display: block;
            width: 100%;
            max-width: 200px;
            margin: 20px auto;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            text-align: center;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .botaocadastro:hover {
            background-color: #45a049;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 10px 0;
            background-color: #333;
            color: white;
        }

        .footer img {
            width: 80px;
            margin-bottom: 5px;
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <div class="logonavbar">
        <img src="./assets/icon/logo.png" alt="Logo" />
        <span>Senhor dos Anéis - Quiz</span>
    </div>

    <!-- Navegação -->
    <div class="itens">
         <!-- Nesta seção, adicionei os links para as páginas principais do site -->
        <a href="./home.html"><span>Home</span></a>
        <a href="./quiz.html"><span>Quiz</span></a>
        <a href="./ranking.html"><span>Ranking</span></a>
    </div>

    <!-- Conteúdo principal -->
    <div class="calculadorafixa">
        <!-- Título da página -->
        <h1>Quiz</h1>
        <span>Responda às perguntas abaixo sobre O Senhor dos Anéis:</span>

         
        <div class="inputsimc">
           <!-- Pergunta 1 -->
            <span>1. Quem criou o Um Anel?</span>
            <select id="q1">
                <option value="#">Selecione</option>
                <option value="a">Sauron</option>
                <option value="b">Gandalf</option>
                <option value="c">Frodo</option>
                <option value="d">Elrond</option>
            </select>

                <!-- Pergunta 2 -->
            <span>2. Quantos membros compõem a Sociedade do Anel?</span>
            <select id="q2">
                <option value="#">Selecione</option>
                <option value="a">7</option>
                <option value="b">8</option>
                <option value="c">9</option>
                <option value="d">10</option>
            </select>

            <!-- Pergunta 3 -->
            <span>3. Quem é o portador do Um Anel em grande parte da história?</span>
            <select id="q3">
                <option value="#">Selecione</option>
                <option value="a">Aragorn</option>
                <option value="b">Frodo</option>
                <option value="c">Legolas</option>
                <option value="d">Sam</option>
            </select>
                <!-- Pergunta 4 -->
            <span>4. Quem é o verdadeiro herdeiro do trono de Gondor?</span>
            <select id="q4">
                <option value="#">Selecione</option>
                <option value="a">Boromir</option>
                <option value="b">Faramir</option>
                <option value="c">Aragorn</option>
                <option value="d">Denethor</option>
            </select>
                    <!-- Pergunta 5 --> 
            <span>5. Qual o nome do mago branco?</span>
            <select id="q5">
                <option value="#">Selecione</option>
                <option value="a">Saruman</option>
                <option value="b">Gandalf</option>
                <option value="c">Radagast</option>
                <option value="d">Tom Bombadil</option>
            </select>

            <!-- Botão para enviar respostas -->
            <button class="botaocadastro" onclick="enviarRespostas()">Enviar Respostas</button>
        </div>
    </div>

    <!-- Rodapé -->
    <div class="footer">
        <img src="./assets/icon/logo.png" alt="Logo" />
        <span>© 2025 Senhor dos Anéis Quiz - Todos os direitos reservados</span>
    </div>

    <script>
        // Criei a função para enviar as respostas do quiz
        function enviarRespostas() {
            // Primeiro, eu crio um array vazio para armazenar as respostas do usuário
            var respostas = [
            ];

            // Pego os valores selecionados nos campos de cada pergunta
            var q1 = document.getElementById("q1").value;
            var q2 = document.getElementById("q2").value;
            var q3 = document.getElementById("q3").value;
            var q4 = document.getElementById("q4").value;
            var q5 = document.getElementById("q5").value;

            // Verifico se o usuário respondeu todas as perguntas
            if (q1 === "#" || q2 === "#" || q3 === "#" || q4 === "#" || q5 === "#") {
                alert("Por favor, responda todas as perguntas!");
                return; // Se faltar alguma resposta, mostro um alerta e paro a função

            }


            // Verifico cada resposta para marcar se está correta ou errada
            // Depois, adiciono ao array 'respostas' com o ID da pergunta, a resposta e se está correta
            if (q1 === "a") {
                respostas.push({ perguntaId: 1, resposta: q1, correta: 1 })
            } else {
                respostas.push({ perguntaId: 1, resposta: q1, correta: 0 })
            }
            if (q2 === "c") {
                respostas.push({ perguntaId: 2, resposta: q2, correta: 1 })
            } else {
                respostas.push({ perguntaId: 2, resposta: q2, correta: 0 })
            }
            if (q3 === "b") {
                respostas.push({ perguntaId: 3, resposta: q3, correta: 1 })
            } else {
                respostas.push({ perguntaId: 3, resposta: q3, correta: 0 })
            } if (q4 === "c") {
                respostas.push({ perguntaId: 4, resposta: q4, correta: 1 })
            } else {
                respostas.push({ perguntaId: 4, resposta: q4, correta: 0 })
            }
            if (q5 === "b") {
                respostas.push({ perguntaId: 5, resposta: q5, correta: 1 })
            } else {
                respostas.push({ perguntaId: 5, resposta: q5, correta: 0 })
            };

            //(31-01)
            // Pego o ID do usuário armazenado na sessão
            var usuarioId = sessionStorage.getItem("ID_USUARIO");

            // Exibo os dados que serão enviados no console para garantir que estão corretos
            console.log("Dados enviados pelo fetch:");
            console.log({ usuarioId, respostas });

            // Envio as respostas para o backend
            fetch("http://localhost:3333/quiz/salvarRespostas", {
                method: "POST", // Método de envio
                headers: {
                    "Content-Type": "application/json", // Especifico o tipo de dado enviado
                },
                // Transformo os dados em JSON
                body: JSON.stringify({ usuarioId: usuarioId, respostas: respostas }),   
            })
                .then(function (response) {
                    if (response.ok) {
                        alert("Respostas enviadas com sucesso!");
                        window.location.href = "./dashboard/dashboard1.html"; // Redirecionei para a pagina dashboard1 - exibindo os resultados
                    } else {
                        alert("Erro ao enviar as respostas.");
                    }
                })
                .catch(function (erro) {
                     // Caso ocorra algum erro na comunicação, mostro no console e aviso o usuário
                    console.error("Erro:", erro);
                    alert("Não foi possível enviar as respostas.");
                });
        }
    </script>

</body>

</html>